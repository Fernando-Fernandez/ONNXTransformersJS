<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ONNX Transformers.JS - LLMs in the browser</title>
    <!-- Link to the main stylesheet -->
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <h1>ONNX Transformers JS - LLMs in the browser</h1>
    <div class="top-row" style="margin-bottom: 1rem; display:flex; gap:1rem; align-items:center;">
        <div class="model-selector">
            <label for="model-select">Model:</label>
            <select id="model-select">
                <!-- options populated dynamically from MODEL_REGISTRY -->
            </select>
        </div>

        <div id="current-model" style="margin-top:0.5rem;font-size:0.95rem;color:#333;">Loaded model: <span id="current-model-name">None</span></div>

        <!-- Status Container: Displays browser compatibility, model loading progress, and performance metrics -->
        <div id="status-container" class="card" style="min-width:260px;">
        <!-- Browser Status: Shows if WebGPU is supported -->
        <div id="browser-status">Checking WebGPU support...</div>

        <!-- Model Status: Shows loading progress bar and file names -->
        <div id="model-status" class="hidden">
            <div>Loading Model: <span id="loading-file">...</span></div>
            <div class="progress-bar">
                <div id="progress-fill" class="progress-fill"></div>
            </div>
            <div id="progress-text">0%</div>
        </div>

        <!-- TPS Status: Shows Tokens Per Second during generation -->
        <div id="tps-status" class="hidden">TPS: <span id="tps-value">0</span></div>
        </div>
    </div>

    <!-- Main Container: Holds the Thought Panel and Chat Interface side-by-side -->
    <div class="main-container">
        <!-- Thought Panel: Displays the model's internal reasoning process -->
        <!-- Hidden by default, toggled via button -->
        <div id="thought-panel" class="thought-panel hidden">
            <div class="panel-header">
                <h3>Thinking Process</h3>
                <button id="close-thought-btn" class="icon-btn">Ã—</button>
            </div>
            <div id="thought-content" class="thought-content"></div>
        </div>

        <!-- Chat Interface: The main interaction area -->
        <div id="chat-interface" class="hidden">
            <div class="chat-container">
                <!-- Messages Area: Where the conversation history is displayed -->
                <div id="messages" class="messages">
                    <!-- Messages will be dynamically appended here -->
                </div>

                <!-- Input Area: Text input and control buttons -->
                <div class="input-area">
                    <textarea id="message-input" placeholder="Type a message (Option+Return for newline)..." autocomplete="off" rows="4"></textarea>
                    <div class="input-area-buttons">
                        <button id="send-btn">Send</button>
                        <button id="stop-btn" disabled>Stop</button>
                    </div>
                </div>
            </div>

            <!-- Status Bar: Additional controls below the chat -->
            <div class="status-bar">
                <button id="reset-btn">Reset Chat</button>
                <button id="toggle-thought-btn">Show Thoughts</button>
            </div>
        </div>
    </div>

    <!-- Load the bundled Transformers library (IIFE format) -->
    <script src="public/transformers_lib.js"></script>
    <!-- Load centralized model registry shared by main thread and workers -->
    <script src="public/models.js"></script>
    <!-- Load the main application logic -->
    <script src="app.js"></script>
</body>

</html>
